import{S as e,i as t,s as n,e as s,c as i,a as l,d as o,b as r,f as a,g as c,l as u,n as f,h,j as p,k as d,m,o as w,p as g,r as x,t as b,u as y,v as $,w as v,x as E,y as k,z as I,A as z,B as D,C as T,D as j,E as O}from"./client.aa0478b5.js";import{g as V,a as A,b as B,f as W,c as C,E as G}from"./index.3781e800.js";function N(e){let t,n,h,p,d,m,w;return{c(){t=s("a"),n=s("figure"),h=s("video"),this.h()},l(e){t=i(e,"A",{rel:!0,href:!0,class:!0});var s=l(t);n=i(s,"FIGURE",{});var r=l(n);h=i(r,"VIDEO",{class:!0,muted:!0,autoplay:!0,playsinline:!0,"webkit-playsinline":!0,poster:!0}),l(h).forEach(o),r.forEach(o),s.forEach(o),this.h()},h(){r(h,"class","w-full bg-white"),h.muted=!0,h.autoplay=!0,h.playsInline=!0,r(h,"webkit-playsinline",""),r(h,"poster",p=V(e[0])),r(t,"rel","prefetch"),r(t,"href",d="/exhibits/"+e[0].key),r(t,"class","m-px exhibit relative w-84")},m(s,i){a(s,t,i),c(t,n),c(n,h),e[3](h),m||(w=u(h,"mouseover",e[2]),m=!0)},p(e,[n]){1&n&&p!==(p=V(e[0]))&&r(h,"poster",p),1&n&&d!==(d="/exhibits/"+e[0].key)&&r(t,"href",d)},i:f,o:f,d(n){n&&o(t),e[3](null),m=!1,w()}}}function R(e,t,n){let s,{exhibit:i}=t,l=!1;return e.$$set=e=>{"exhibit"in e&&n(0,i=e.exhibit)},[i,s,function(){l||(l=!0,n(1,s.src=A(i),s),n(1,s.oncanplay=()=>{n(1,s.poster=B(i),s),s.play()},s))},function(e){h[e?"unshift":"push"]((()=>{s=e,n(1,s)}))}]}class F extends e{constructor(e){super(),t(this,e,R,N,n,{exhibit:0})}}function H(e){let t,n,c,u;return{c(){t=s("video"),this.h()},l(e){t=i(e,"VIDEO",{class:!0,muted:!0,playsinline:!0,"webkit-playsinline":!0,poster:!0}),l(t).forEach(o),this.h()},h(){r(t,"class","absolute inset-0 w-full z-10"),t.muted=!0,t.playsInline=!0,r(t,"webkit-playsinline",""),r(t,"poster",n=V(e[0]))},m(n,s){a(n,t,s),e[12](t),u=!0},p(e,s){(!u||1&s&&n!==(n=V(e[0])))&&r(t,"poster",n)},i(e){u||(c&&c.end(1),u=!0)},o(e){e&&(c=d(t,W,{})),u=!1},d(n){n&&o(t),e[12](null),n&&c&&c.end()}}}function M(e){let t,n,f,h,d,k,I,z,D,T,j=!1,O=()=>{j=!1};p(e[10]),p(e[11]);let V=e[7]&&H(e);return{c(){n=s("div"),f=s("a"),V&&V.c(),h=m(),d=s("img"),this.h()},l(e){n=i(e,"DIV",{class:!0,style:!0});var t=l(n);f=i(t,"A",{rel:!0,href:!0,class:!0});var s=l(f);V&&V.l(s),h=w(s),d=i(s,"IMG",{class:!0,src:!0}),s.forEach(o),t.forEach(o),this.h()},h(){r(d,"class","absolute inset-0 z-0"),d.src!==(k=C(e[0]))&&r(d,"src",k),r(f,"rel","prefetch"),r(f,"href",I="/exhibits/"+e[0].key),r(f,"class","m-px w-full"),r(n,"class","relative w-full m-1 mx-2 h-96"),g(n,"height",e[8]+"px"),p((()=>e[13].call(n)))},m(s,i){a(s,n,i),c(n,f),V&&V.m(f,null),c(f,h),c(f,d),z=x(n,e[13].bind(n)),e[14](n),D||(T=[u(window,"scroll",e[9]),u(window,"scroll",(()=>{j=!0,clearTimeout(t),t=setTimeout(O,100),e[10]()})),u(window,"resize",e[11])],D=!0)},p(e,[s]){24&s&&!j&&(j=!0,clearTimeout(t),scrollTo(e[3],e[4]),t=setTimeout(O,100)),e[7]?V?(V.p(e,s),128&s&&b(V,1)):(V=H(e),V.c(),b(V,1),V.m(f,h)):V&&(y(),$(V,1,1,(()=>{V=null})),v()),1&s&&d.src!==(k=C(e[0]))&&r(d,"src",k),1&s&&I!==(I="/exhibits/"+e[0].key)&&r(f,"href",I),256&s&&g(n,"height",e[8]+"px")},i(e){b(V)},o(e){$(V)},d(t){t&&o(n),V&&V.d(),z(),e[14](null),D=!1,E(T)}}}function P(...e){console.log("[autoplay]",...e)}function S(e,t,n){let s,i,l,o,r,a,c,{exhibit:u}=t,f=!0,p=!1,d=!1;function m(e){const t=i.getBoundingClientRect(),l=t.top>=0&&t.bottom<=e,o=t.bottom<=0||t.top>=e;l&&!p&&(console.log("Playing video "+u.key,t),d||(d=!0,n(7,f=!0),n(1,s.src=A(u),s),s.play(),P("init video element"),n(1,s.oncanplay=()=>{P("canplay fired"),s.play()},s),n(1,s.onerror=()=>{P("onerror fired")},s),n(1,s.onended=()=>{P("onended fired"),f&&(n(7,f=!1),p=!0)},s))),o&&d&&s&&(s.pause(),n(1,s.src=null,s),s.load(),d=!1)}return k((()=>{m(a)})),e.$$set=e=>{"exhibit"in e&&n(0,u=e.exhibit)},[u,s,i,l,o,r,a,f,c,function(){m(a)},function(){n(3,l=window.pageXOffset),n(4,o=window.pageYOffset)},function(){n(5,r=window.innerWidth),n(6,a=window.innerHeight)},function(e){h[e?"unshift":"push"]((()=>{s=e,n(1,s)}))},function(){c=this.clientWidth,n(8,c)},function(e){h[e?"unshift":"push"]((()=>{i=e,n(2,i)}))}]}class U extends e{constructor(e){super(),t(this,e,S,M,n,{exhibit:0})}}function X(e,t,n){const s=e.slice();return s[3]=t[n],s}function Y(e){let t,n,s=G,i=[];for(let t=0;t<s.length;t+=1)i[t]=K(X(e,s,t));const l=e=>$(i[e],1,1,(()=>{i[e]=null}));return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=I()},l(e){for(let t=0;t<i.length;t+=1)i[t].l(e);t=I()},m(e,s){for(let t=0;t<i.length;t+=1)i[t].m(e,s);a(e,t,s),n=!0},p(e,n){if(2&n){let o;for(s=G,o=0;o<s.length;o+=1){const l=X(e,s,o);i[o]?(i[o].p(l,n),b(i[o],1)):(i[o]=K(l),i[o].c(),b(i[o],1),i[o].m(t.parentNode,t))}for(y(),o=s.length;o<i.length;o+=1)l(o);v()}},i(e){if(!n){for(let e=0;e<s.length;e+=1)b(i[e]);n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)$(i[e]);n=!1},d(e){z(i,e),e&&o(t)}}}function q(e){let t,n;return t=new F({props:{exhibit:e[3]}}),{c(){D(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,s){j(t,e,s),n=!0},p:f,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){$(t.$$.fragment,e),n=!1},d(e){O(t,e)}}}function J(e){let t,n;return t=new U({props:{exhibit:e[3]}}),{c(){D(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,s){j(t,e,s),n=!0},p:f,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){$(t.$$.fragment,e),n=!1},d(e){O(t,e)}}}function K(e){let t,n,s,i;const l=[J,q],r=[];function c(e,t){return e[1]?0:1}return t=c(e),n=r[t]=l[t](e),{c(){n.c(),s=I()},l(e){n.l(e),s=I()},m(e,n){r[t].m(e,n),a(e,s,n),i=!0},p(e,i){let o=t;t=c(e),t===o?r[t].p(e,i):(y(),$(r[o],1,1,(()=>{r[o]=null})),v(),n=r[t],n||(n=r[t]=l[t](e),n.c()),b(n,1),n.m(s.parentNode,s))},i(e){i||(b(n),i=!0)},o(e){$(n),i=!1},d(e){r[t].d(e),e&&o(s)}}}function L(e){let t,n,c,f;p(e[2]);let h=!!e[0]&&Y(e);return{c(){t=s("div"),h&&h.c(),this.h()},l(e){t=i(e,"DIV",{class:!0});var n=l(t);h&&h.l(n),n.forEach(o),this.h()},h(){r(t,"class","flex text-white justify-center flex-wrap")},m(s,i){a(s,t,i),h&&h.m(t,null),n=!0,c||(f=u(window,"resize",e[2]),c=!0)},p(e,[n]){e[0]?h?(h.p(e,n),1&n&&b(h,1)):(h=Y(e),h.c(),b(h,1),h.m(t,null)):h&&(y(),$(h,1,1,(()=>{h=null})),v())},i(e){n||(b(h),n=!0)},o(e){$(h),n=!1},d(e){e&&o(t),h&&h.d(),c=!1,f()}}}function Q(e,t,n){let s,i;return e.$$.update=()=>{1&e.$$.dirty&&n(1,i=s<768)},[s,i,function(){n(0,s=window.innerWidth)}]}export default class extends e{constructor(e){super(),t(this,e,Q,L,n,{})}}
